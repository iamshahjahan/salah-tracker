Feature: Password Reset # features/authentication/password_reset.feature:1
  As a user who forgot their password
  I want to reset my password using my email
  So that I can regain access to my account
  Feature: Password Reset  # features/authentication/password_reset.feature:1

  @smoke @api
  Scenario: Successful password reset flow                                        # features/authentication/password_reset.feature:12
    Given the application is running                                              # None
    And the database is clean                                                     # None
    And a user with email "test@example.com" and password "oldpassword123" exists # None
    Given I am on the login page                                                  # None
    When I click "Forgot Password"                                                # None
    And I enter my email for password reset "test@example.com"                    # None
    And I submit the forgot password form                                         # None
    Then I should receive a password reset email                                  # None
    And I should see a success message                                            # None

  @smoke @api
  Scenario: Reset password with valid code                                        # features/authentication/password_reset.feature:21
    Given the application is running                                              # features/steps/authentication_steps.py:12
    And the database is clean                                                     # features/steps/authentication_steps.py:20
    And a user with email "test@example.com" and password "oldpassword123" exists # features/steps/authentication_steps.py:40
    Given I have a valid password reset code for "test@example.com"               # features/steps/authentication_steps.py:396
    When I navigate to the reset password page with the code                      # features/steps/authentication_steps.py:451
    And I enter a new password "newpassword123"                                   # features/steps/authentication_steps.py:460
    And I confirm the new password "newpassword123"                               # features/steps/authentication_steps.py:466
    And I submit the reset password form                                          # features/steps/authentication_steps.py:472
    Then my password should be reset successfully                                 # features/steps/authentication_steps.py:482
    And I should be able to login with the new password                           # features/steps/authentication_steps.py:489

  @smoke @api
  Scenario: Reset password with invalid code                                      # features/authentication/password_reset.feature:31
    Given the application is running                                              # None
    And the database is clean                                                     # None
    And a user with email "test@example.com" and password "oldpassword123" exists # None
    Given I have an invalid password reset code                                   # None
    When I navigate to the reset password page with the code                      # None
    Then I should see an error message about invalid code                         # None

  @smoke @api
  Scenario: Reset password with expired code                                      # features/authentication/password_reset.feature:37
    Given the application is running                                              # None
    And the database is clean                                                     # None
    And a user with email "test@example.com" and password "oldpassword123" exists # None
    Given I have an expired password reset code for "test@example.com"            # None
    When I navigate to the reset password page with the code                      # None
    Then I should see an error message about expired code                         # None

  @smoke @api
  Scenario: Reset password with mismatched passwords                              # features/authentication/password_reset.feature:43
    Given the application is running                                              # None
    And the database is clean                                                     # None
    And a user with email "test@example.com" and password "oldpassword123" exists # None
    Given I have a valid password reset code for "test@example.com"               # None
    When I navigate to the reset password page with the code                      # None
    And I enter a new password "newpassword123"                                   # None
    And I confirm the new password "differentpassword123"                         # None
    And I submit the reset password form                                          # None
    Then I should see an error message about password mismatch                    # None
    And my password should not be changed                                         # None

