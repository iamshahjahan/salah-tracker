Feature: Simple Test # features/test_simple.feature:1
  As a developer
  I want to test the BDD setup
  So that I can verify everything works
  @smoke
  Scenario: Simple test scenario        # features/test_simple.feature:7
    Given the application is running    # features/steps/authentication_steps.py:10
    Then I should see a success message # features/steps/email_verification_steps.py:155

Feature: API Endpoints # features/api/api_endpoints.feature:1
  As a developer
  I want to access the application via API endpoints
  So that I can integrate with other systems
  Feature: API Endpoints  # features/api/api_endpoints.feature:1

  @smoke @api
  Scenario: Get prayer times via API                     # features/api/api_endpoints.feature:11
    Given the application is running                     # features/steps/authentication_steps.py:10
    And the API is accessible                            # features/steps/api_steps.py:10
    Given I have a valid API token                       # features/steps/api_steps.py:18
    When I make a GET request to "/api/prayers/times"    # features/steps/api_steps.py:60
    Then I should receive a 200 response                 # features/steps/api_steps.py:230
      ASSERT FAILED: Expected status code 200, but got 422

    And the response should contain today's prayer times # None
    And the response should be in JSON format            # None

  @api
  Scenario: Complete prayer via API                                                              # features/api/api_endpoints.feature:19
    Given the application is running                                                             # None
    And the API is accessible                                                                    # None
    Given I have a valid API token                                                               # None
    And I am within the Dhuhr prayer time window                                                 # None
    When I make a POST request to "/api/prayers/complete" With the prayer ID and completion time # None
    Then I should receive a 200 response                                                         # None
    And the prayer should be marked as completed                                                 # None
    And the response should contain success message                                              # None

  @api
  Scenario: Get dashboard statistics via API                # features/api/api_endpoints.feature:28
    Given the application is running                        # None
    And the API is accessible                               # None
    Given I have a valid API token                          # None
    And I have prayer completion history                    # None
    When I make a GET request to "/api/dashboard/stats"     # None
    Then I should receive a 200 response                    # None
    And the response should contain completion statistics   # None
    And the response should contain weekly and monthly data # None

  @api
  Scenario: API authentication with invalid token           # features/api/api_endpoints.feature:37
    Given the application is running                        # None
    And the API is accessible                               # None
    Given I have an invalid API token                       # None
    When I make a GET request to "/api/prayers/times"       # None
    Then I should receive a 401 response                    # None
    And the response should contain an authentication error # None

  @api
  Scenario: API rate limiting                                        # features/api/api_endpoints.feature:44
    Given the application is running                                 # None
    And the API is accessible                                        # None
    Given I have a valid API token                                   # None
    When I make 100 requests to "/api/prayers/times" within 1 minute # None
    Then I should be rate limited                                    # None
    And I should receive a 429 response                              # None
    And the response should contain rate limit information           # None

  @api
  Scenario: API input validation                                                 # features/api/api_endpoints.feature:52
    Given the application is running                                             # None
    And the API is accessible                                                    # None
    Given I have a valid API token                                               # None
    When I make a POST request to "/api/prayers/complete" With invalid prayer ID # None
    Then I should receive a 400 response                                         # None
    And the response should contain validation error                             # None

  @api
  Scenario: API error handling                        # features/api/api_endpoints.feature:59
    Given the application is running                  # None
    And the API is accessible                         # None
    Given I have a valid API token                    # None
    When I make a request to a non-existent endpoint  # None
    Then I should receive a 404 response              # None
    And the response should contain a not found error # None

  @api
  Scenario: API response format consistency                   # features/api/api_endpoints.feature:66
    Given the application is running                          # None
    And the API is accessible                                 # None
    Given I have a valid API token                            # None
    When I make requests to various API endpoints             # None
    Then all responses should follow the same format          # None
    And all responses should include appropriate status codes # None
    And all responses should include error handling           # None

  @api
  Scenario: API versioning                               # features/api/api_endpoints.feature:74
    Given the application is running                     # None
    And the API is accessible                            # None
    Given I have a valid API token                       # None
    When I make a request to "/api/v1/prayers/times"     # None
    Then I should receive a 200 response                 # None
    And the response should be compatible with version 1 # None

  @api
  Scenario: API documentation accessibility              # features/api/api_endpoints.feature:81
    Given the application is running                     # None
    And the API is accessible                            # None
    When I make a GET request to "/api/docs"             # None
    Then I should receive a 200 response                 # None
    And the response should contain API documentation    # None
    And the documentation should be in a readable format # None

Feature: Password Reset # features/authentication/password_reset.feature:1
  As a user who forgot their password
  I want to reset my password using my email
  So that I can regain access to my account
  Feature: Password Reset  # features/authentication/password_reset.feature:1

  @smoke @api
  Scenario: Successful password reset flow                                        # features/authentication/password_reset.feature:12
    Given the application is running                                              # features/steps/authentication_steps.py:10
    And the database is clean                                                     # features/steps/authentication_steps.py:18
    And a user with email "test@example.com" and password "oldpassword123" exists # features/steps/authentication_steps.py:38
    Given I am on the login page                                                  # features/steps/authentication_steps.py:32
    When I click "Forgot Password"                                                # features/steps/authentication_steps.py:368
    And I enter my email for password reset "test@example.com"                    # features/steps/authentication_steps.py:374
    And I submit the forgot password form                                         # features/steps/authentication_steps.py:380
      ABORTED: By user (KeyboardInterrupt).

    Then I should receive a password reset email                                  # None
    And I should see a success message                                            # None
----
CAPTURED STDERR: scenario
ABORTED: KeyboardInterrupt
---- CAPTURED_SCENARIO_OUTPUT_END ----

