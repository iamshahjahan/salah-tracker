<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SalahTracker - Your Prayer Companion</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <i class="fas fa-mosque"></i>
                    <span>SalahTracker</span>
                </div>
                <div class="nav-menu" id="nav-menu">
                    <a href="#home" class="nav-link active">Home</a>
                    <a href="#prayers" class="nav-link">Prayers</a>
                    <a href="#dashboard" class="nav-link">Dashboard</a>
                    <a href="#family" class="nav-link">Family</a>
                    <a href="#profile" class="nav-link">Profile</a>
                </div>
                <div class="nav-toggle" id="nav-toggle">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Section -->
            <section id="home" class="section active">
                <!-- Hero Section -->
                <div class="hero">
                    <div class="hero-content">
                        <h1 class="hero-title">Welcome to SalahTracker</h1>
                        <p class="hero-subtitle">Stay consistent with your daily prayers and grow spiritually with your community</p>
                        <div class="hero-buttons">
                            <button class="btn btn-primary" onclick="showLogin()">Get Started</button>
                            <button class="btn btn-secondary" onclick="showRegister()">Create Account</button>
                        </div>
                    </div>
                    <div class="hero-image">
                        <i class="fas fa-mosque hero-icon"></i>
                    </div>
                </div>

                <!-- Features Section -->
                <div class="features-section">
                    <div class="container">
                        <h2 class="section-title">Why Choose SalahTracker?</h2>
                        <div class="features-grid">
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <h3>Smart Reminders</h3>
                                <p>Get personalized prayer time reminders via email with beautiful Quranic verses and Hadith</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h3>Track Progress</h3>
                                <p>Monitor your prayer consistency with detailed analytics and beautiful visualizations</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h3>Family Groups</h3>
                                <p>Create family prayer groups and encourage each other in your spiritual journey</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <h3>One-Click Completion</h3>
                                <p>Mark prayers as completed directly from email links for ultimate convenience</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Prayer Times Preview -->
                <div class="prayer-times-preview">
                    <div class="container">
                        <h2 class="section-title">Today's Prayer Times</h2>
                        <div class="prayer-times-grid" id="prayerTimesPreview">
                            <div class="prayer-time-card">
                                <div class="prayer-name">Fajr</div>
                                <div class="prayer-time">05:10</div>
                            </div>
                            <div class="prayer-time-card">
                                <div class="prayer-name">Dhuhr</div>
                                <div class="prayer-time">12:16</div>
                            </div>
                            <div class="prayer-time-card">
                                <div class="prayer-name">Asr</div>
                                <div class="prayer-time">16:38</div>
                            </div>
                            <div class="prayer-time-card">
                                <div class="prayer-name">Maghrib</div>
                                <div class="prayer-time">18:23</div>
                            </div>
                            <div class="prayer-time-card">
                                <div class="prayer-name">Isha</div>
                                <div class="prayer-time">19:21</div>
                            </div>
                        </div>
                        <p class="prayer-times-note">* Times shown for Bangalore, India. Create an account to get personalized prayer times for your location.</p>
                    </div>
                </div>

                <!-- Inspirational Quote -->
                <div class="inspirational-section">
                    <div class="container">
                        <div class="quote-card">
                            <div class="quote-icon">
                                <i class="fas fa-quote-left"></i>
                            </div>
                            <blockquote class="quote-text">
                                "And establish prayer for My remembrance."
                            </blockquote>
                            <cite class="quote-source">- Quran 20:14</cite>
                        </div>
                    </div>
                </div>

                <!-- Call to Action -->
                <div class="cta-section">
                    <div class="container">
                        <h2 class="cta-title">Ready to Transform Your Prayer Journey?</h2>
                        <p class="cta-subtitle">Join thousands of Muslims who are building consistent prayer habits with SalahTracker</p>
                        <div class="cta-buttons">
                            <button class="btn btn-primary btn-large" onclick="showRegister()">
                                <i class="fas fa-user-plus"></i> Start Your Journey
                            </button>
                            <button class="btn btn-secondary btn-large" onclick="showLogin()">
                                <i class="fas fa-sign-in-alt"></i> Already Have Account?
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Login Modal -->
            <div id="loginModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal('loginModal')">&times;</span>
                    <h2>Login to Your Account</h2>

                    <!-- Login Method Selection -->
                    <div class="login-method-selection">
                        <div class="method-tabs">
                            <button type="button" class="method-tab active" onclick="switchLoginMethod('password')">
                                <i class="fas fa-key"></i> Password
                            </button>
                            <button type="button" class="method-tab" onclick="switchLoginMethod('otp')">
                                <i class="fas fa-envelope"></i> Email Code
                            </button>
                        </div>
                    </div>

                    <!-- Password Login Form -->
                    <form id="loginForm" class="login-form active">
                        <div class="form-group">
                            <label for="loginUsername">Username or Email</label>
                            <input type="text" id="loginUsername" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Login</button>
                    </form>

                    <!-- OTP Login Form -->
                    <form id="otpLoginForm" class="login-form">
                        <div class="form-group">
                            <label for="otpEmail">Email Address</label>
                            <input type="email" id="otpEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <button type="button" class="btn btn-secondary btn-full" onclick="sendLoginOTP()">
                                <i class="fas fa-paper-plane"></i> Send Login Code
                            </button>
                        </div>
                        <div class="form-group" id="otpCodeGroup" style="display: none;">
                            <label for="otpCode">Enter 6-digit code</label>
                            <input type="text" id="otpCode" name="otp" maxlength="6" pattern="[0-9]{6}" placeholder="123456">
                        </div>
                        <button type="submit" class="btn btn-primary btn-full" id="otpLoginBtn" style="display: none;">
                            <i class="fas fa-sign-in-alt"></i> Login with Code
                        </button>
                    </form>

                    <div class="modal-footer">
                        <p>
                            <a href="#" onclick="showForgotPassword()">Forgot Password?</a>
                        </p>
                        <p>
                            Don't have an account? <a href="#" onclick="showRegister()">Register here</a>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Register Modal -->
            <div id="registerModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal('registerModal')">&times;</span>
                    <h2>Create Your Account</h2>
                    <form id="registerForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="regFirstName">First Name</label>
                                <input type="text" id="regFirstName" name="first_name" required>
                            </div>
                            <div class="form-group">
                                <label for="regLastName">Last Name</label>
                                <input type="text" id="regLastName" name="last_name" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="regUsername">Username</label>
                            <input type="text" id="regUsername" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="regEmail">Email</label>
                            <input type="email" id="regEmail" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="regPassword">Password</label>
                            <input type="password" id="regPassword" name="password" required>
                        </div>
                        <div class="form-group">
                            <label for="regPhone">Phone Number (Optional)</label>
                            <input type="tel" id="regPhone" name="phone_number">
                        </div>
                        <div class="form-group">
                            <label>Location for Prayer Times</label>
                            <div class="location-selection">
                                <div class="location-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>We'll automatically detect your location for accurate prayer times</span>
                                </div>
                                <div class="location-options" id="locationOptions" style="display: none;">
                                    <div class="detected-location" id="detectedLocation">
                                        <h4><i class="fas fa-crosshairs"></i> Detected Location</h4>
                                        <div class="location-details" id="locationDetails"></div>
                                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="useDetectedLocation()">
                                            <i class="fas fa-check"></i> Use This Location
                                        </button>
                                    </div>
                                    <div class="common-cities">
                                        <h4><i class="fas fa-globe"></i> Or Choose a City</h4>
                                        <div class="city-grid">
                                            <button type="button" class="city-btn" onclick="selectCity('Bangalore', 12.9716, 77.5946, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Bangalore, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Mumbai', 19.0760, 72.8777, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Mumbai, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Delhi', 28.7041, 77.1025, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Delhi, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Chennai', 13.0827, 80.2707, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Chennai, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Kolkata', 22.5726, 88.3639, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Kolkata, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Hyderabad', 17.3850, 78.4867, 'Asia/Kolkata')">
                                                <i class="fas fa-city"></i> Hyderabad, India
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('Dubai', 25.2048, 55.2708, 'Asia/Dubai')">
                                                <i class="fas fa-city"></i> Dubai, UAE
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('London', 51.5074, -0.1278, 'Europe/London')">
                                                <i class="fas fa-city"></i> London, UK
                                            </button>
                                            <button type="button" class="city-btn" onclick="selectCity('New York', 40.7128, -74.0060, 'America/New_York')">
                                                <i class="fas fa-city"></i> New York, USA
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="selected-location" id="selectedLocation" style="display: none;">
                                    <h4><i class="fas fa-check-circle"></i> Selected Location</h4>
                                    <div class="location-details" id="selectedLocationDetails"></div>
                                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="changeLocation()">
                                        <i class="fas fa-edit"></i> Change Location
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Create Account</button>
                    </form>
                    <p class="modal-footer">
                        Already have an account? <a href="#" onclick="showLogin()">Login here</a>
                    </p>
                </div>
            </div>

            <!-- Prayers Section -->
            <section id="prayers" class="section">
                <div class="container">
                    <div class="prayer-header">
                        <h2 class="section-title">Today's Prayers</h2>
                        <div class="prayer-date" id="prayerDate">Loading...</div>
                    </div>
                    <div class="prayer-times" id="prayerTimes">
                        <div class="loading">Loading prayer times...</div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section -->
            <section id="dashboard" class="section">
                <div class="container">
                    <h2 class="section-title">Your Prayer Dashboard</h2>

                    <!-- Weekly Calendar Navigation -->
                    <div class="weekly-calendar-header">
                        <button class="week-nav-btn" onclick="previousWeek()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="week-info">
                            <h3 class="week-title" id="weekTitle">Week of September 9, 2025</h3>
                            <p class="week-subtitle" id="weekSubtitle">Track your daily prayers</p>
                        </div>
                        <button class="week-nav-btn" onclick="nextWeek()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>

                    <!-- Weekly Calendar Grid -->
                    <div class="weekly-calendar-container">
                        <!-- Mobile Day Navigation (hidden on desktop) -->
                        <div class="mobile-day-nav" id="mobileDayNav" style="display: none;">
                            <button class="mobile-day-nav-btn" id="prevDayBtn" onclick="previousDay()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div class="mobile-day-info">
                                <div class="mobile-day-title" id="mobileDayTitle">Thursday, Sep 11</div>
                                <div class="mobile-day-subtitle" id="mobileDaySubtitle">5/5 Complete</div>
                            </div>
                            <button class="mobile-day-nav-btn" id="nextDayBtn" onclick="nextDay()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <div class="weekly-calendar-grid" id="weeklyCalendarGrid">
                            <div class="loading">Loading weekly calendar...</div>
                        </div>
                    </div>

                    <!-- Selected Day Prayer Times -->
                    <div class="selected-day-prayers" id="selectedDayPrayers" style="display: none;">
                        <h4 class="selected-day-title" id="selectedDayTitle">Prayer Times for Selected Day</h4>
                        <div class="selected-day-content" id="selectedDayContent">
                            <div class="loading">Loading prayer times...</div>
                        </div>
                    </div>

                    <!-- Dashboard Stats -->
                    <div class="dashboard-stats" id="dashboardStats">
                        <div class="loading">Loading dashboard...</div>
                    </div>
                </div>
            </section>

            <!-- Family Section -->
            <section id="family" class="section">
                <div class="container">
                    <h2 class="section-title">Family & Friends</h2>
                    <div class="family-section">
                        <button class="btn btn-primary" onclick="showAddFamilyModal()">
                            <i class="fas fa-plus"></i> Add Family Member
                        </button>
                        <div class="family-members" id="familyMembers">
                            <div class="loading">Loading family members...</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile" class="section">
                <div class="container">
                    <h2 class="section-title">Your Profile</h2>
                    <div class="profile-content" id="profileContent">
                        <div class="loading">Loading profile...</div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Add Family Member Modal -->
        <div id="addFamilyModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('addFamilyModal')">&times;</span>
                <h2>Add Family Member</h2>
                <form id="addFamilyForm">
                    <div class="form-group">
                        <label for="familyName">Name</label>
                        <input type="text" id="familyName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="familyRelationship">Relationship</label>
                        <select id="familyRelationship" name="relationship" required>
                            <option value="">Select Relationship</option>
                            <option value="spouse">Spouse</option>
                            <option value="child">Child</option>
                            <option value="parent">Parent</option>
                            <option value="sibling">Sibling</option>
                            <option value="friend">Friend</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="familyEmail">Email (Optional)</label>
                        <input type="email" id="familyEmail" name="email">
                    </div>
                    <div class="form-group">
                        <label for="familyPhone">Phone Number (Optional)</label>
                        <input type="tel" id="familyPhone" name="phone_number">
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="familyReminders" name="reminder_enabled" checked>
                            Enable prayer reminders for this person
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Add Family Member</button>
                </form>
            </div>
        </div>

        <!-- Email Verification Modal -->
        <div id="emailVerificationModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('emailVerificationModal')">&times;</span>
                <h2>Verify Your Email</h2>
                <p>We've sent a 6-digit verification code to your email address. Please enter it below.</p>
                <form id="emailVerificationForm">
                    <div class="form-group">
                        <label for="verificationEmail">Email Address</label>
                        <input type="email" id="verificationEmail" name="email" readonly>
                    </div>
                    <div class="form-group">
                        <label for="verificationCode">Verification Code</label>
                        <input type="text" id="verificationCode" name="code" maxlength="6" pattern="[0-9]{6}" placeholder="123456" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Verify Email</button>
                </form>
                <div class="modal-footer">
                    <p>
                        Didn't receive the code?
                        <a href="#" onclick="resendVerificationCode()">Resend Code</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Forgot Password Modal -->
        <div id="forgotPasswordModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('forgotPasswordModal')">&times;</span>
                <h2>Reset Your Password</h2>
                <p>Enter your email address and we'll send you a password reset link.</p>
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="forgotPasswordEmail">Email Address</label>
                        <input type="email" id="forgotPasswordEmail" name="email" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Send Reset Link</button>
                </form>
                <div class="modal-footer">
                    <p>
                        Remember your password?
                        <a href="#" onclick="showLogin()">Back to Login</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Reset Password Modal -->
        <div id="resetPasswordModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('resetPasswordModal')">&times;</span>
                <h2>Set New Password</h2>
                <p>Enter your new password below.</p>
                <form id="resetPasswordForm">
                    <div class="form-group">
                        <label for="resetCode">Reset Code</label>
                        <input type="text" id="resetCode" name="code" readonly>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">New Password</label>
                        <input type="password" id="newPassword" name="new_password" required>
                    </div>
                    <div class="form-group">
                        <label for="confirmNewPassword">Confirm New Password</label>
                        <input type="password" id="confirmNewPassword" name="confirm_password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Reset Password</button>
                </form>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
